{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport { collection, doc, getDoc, onSnapshot, orderBy, query, where } from 'firebase/firestore';\nimport { database } from \"../../firebase\";\n\nvar FirebaseGetFriends = function FirebaseGetFriends(owner) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      friends = _useState2[0],\n      setFriends = _useState2[1];\n\n  if (!owner || !owner.length) {\n    setFriends([]);\n    return;\n  }\n\n  useEffect(function () {\n    var arrTemp = [];\n    var unsubcribe = onSnapshot(doc(database, \"UserFriends\", owner), function (document) {\n      var dataTemp = document.data().listFriend;\n      dataTemp.map(function _callee(obj) {\n        var docRef, docSnap;\n        return _regeneratorRuntime.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                docRef = doc(database, \"Users\", obj.idFriend);\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(getDoc(docRef));\n\n              case 3:\n                docSnap = _context.sent;\n                arrTemp.push(docSnap.data());\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      });\n      console.log('LIST FRIENDS :: ', arrTemp);\n      setTimeout(function () {\n        setFriends(arrTemp);\n      }, 1000);\n    });\n    return unsubcribe;\n  }, [owner]);\n  return friends;\n};\n\nexport default FirebaseGetFriends;","map":{"version":3,"names":["React","useEffect","useState","collection","doc","getDoc","onSnapshot","orderBy","query","where","database","FirebaseGetFriends","owner","friends","setFriends","length","arrTemp","unsubcribe","document","dataTemp","data","listFriend","map","obj","docRef","idFriend","docSnap","push","console","log","setTimeout"],"sources":["F:/Hoc ki 4/Cong nghe moi/AppChat/client/Components/service/FirebaseGetFriends.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { collection, doc, getDoc, onSnapshot, orderBy, query, where } from 'firebase/firestore';\r\nimport { database } from '../../firebase';\r\n\r\n//UseEffect này luôn lắng nge\r\n//UseEffect này chỉ chạy lại khi biến owner lớp cha gọi nó thay đổi giá trị truyền vào\r\n//Nếu thay đổi hàm sẽ đc thực thi => trả về danh sách rooms mới.\r\nconst FirebaseGetFriends = (owner) => {\r\n    const [friends, setFriends] = useState([]);\r\n    if(!owner || !owner.length){\r\n        setFriends([]);\r\n        return;\r\n    }\r\n    useEffect(() => {\r\n        const arrTemp = [];\r\n        const unsubcribe = onSnapshot(doc(database, \"UserFriends\", owner), (document) => {\r\n            const dataTemp = document.data().listFriend;\r\n            dataTemp.map(async (obj) => {\r\n                \r\n                const docRef = doc(database, \"Users\", obj.idFriend);\r\n                const docSnap = await getDoc(docRef);\r\n                arrTemp.push(docSnap.data());\r\n\r\n            });\r\n            console.log('LIST FRIENDS :: ', arrTemp);\r\n            setTimeout(() => {\r\n                setFriends(arrTemp);\r\n            }, 1000);\r\n        });\r\n        return unsubcribe;\r\n    }, [owner]);\r\n    return friends;\r\n};\r\n\r\nexport default FirebaseGetFriends;"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,EAAqBC,GAArB,EAA0BC,MAA1B,EAAkCC,UAAlC,EAA8CC,OAA9C,EAAuDC,KAAvD,EAA8DC,KAA9D,QAA2E,oBAA3E;AACA,SAASC,QAAT;;AAKA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,KAAD,EAAW;EAClC,gBAA8BV,QAAQ,CAAC,EAAD,CAAtC;EAAA;EAAA,IAAOW,OAAP;EAAA,IAAgBC,UAAhB;;EACA,IAAG,CAACF,KAAD,IAAU,CAACA,KAAK,CAACG,MAApB,EAA2B;IACvBD,UAAU,CAAC,EAAD,CAAV;IACA;EACH;;EACDb,SAAS,CAAC,YAAM;IACZ,IAAMe,OAAO,GAAG,EAAhB;IACA,IAAMC,UAAU,GAAGX,UAAU,CAACF,GAAG,CAACM,QAAD,EAAW,aAAX,EAA0BE,KAA1B,CAAJ,EAAsC,UAACM,QAAD,EAAc;MAC7E,IAAMC,QAAQ,GAAGD,QAAQ,CAACE,IAAT,GAAgBC,UAAjC;MACAF,QAAQ,CAACG,GAAT,CAAa,iBAAOC,GAAP;QAAA;QAAA;UAAA;YAAA;cAAA;gBAEHC,MAFG,GAEMpB,GAAG,CAACM,QAAD,EAAW,OAAX,EAAoBa,GAAG,CAACE,QAAxB,CAFT;gBAAA;gBAAA,iCAGapB,MAAM,CAACmB,MAAD,CAHnB;;cAAA;gBAGHE,OAHG;gBAITV,OAAO,CAACW,IAAR,CAAaD,OAAO,CAACN,IAAR,EAAb;;cAJS;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAAb;MAOAQ,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCb,OAAhC;MACAc,UAAU,CAAC,YAAM;QACbhB,UAAU,CAACE,OAAD,CAAV;MACH,CAFS,EAEP,IAFO,CAAV;IAGH,CAb4B,CAA7B;IAcA,OAAOC,UAAP;EACH,CAjBQ,EAiBN,CAACL,KAAD,CAjBM,CAAT;EAkBA,OAAOC,OAAP;AACH,CAzBD;;AA2BA,eAAeF,kBAAf"},"metadata":{},"sourceType":"module"}