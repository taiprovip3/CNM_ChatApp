{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport { auth, database } from \"../../firebase\";\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { io } from 'socket.io-client';\nimport { doc, getDoc } from 'firebase/firestore';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = React.createContext();\nexport default function AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentUser = _useState2[0],\n      setCurrentUser = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      socket = _useState4[0],\n      setSocket = _useState4[1];\n\n  useEffect(function () {\n    setSocket(io.connect(\"http://localhost:4000\"));\n    onAuthStateChanged(auth, function (user) {\n      if (user) {\n        var uid = user.uid;\n        var UsersDocRef = doc(database, \"Users\", uid);\n        getDoc(UsersDocRef).then(function (docSnap) {\n          setCurrentUser(docSnap.data());\n        }).catch(function (error) {\n          console.log('(x) In AuthProvider error: ', error);\n        });\n      } else {\n        setCurrentUser(user);\n      }\n    });\n  }, []);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      currentUser: currentUser,\n      socket: socket\n    },\n    children: children\n  });\n}\n;","map":{"version":3,"names":["React","useEffect","useState","auth","database","onAuthStateChanged","io","doc","getDoc","AuthContext","createContext","AuthProvider","children","currentUser","setCurrentUser","socket","setSocket","connect","user","uid","UsersDocRef","then","docSnap","data","catch","error","console","log"],"sources":["F:/Hoc ki 4/Cong nghe moi/AppChat/client/Components/provider/AuthProvider.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { auth, database } from '../../firebase';\r\nimport { onAuthStateChanged } from 'firebase/auth';\r\nimport { io } from 'socket.io-client';\r\nimport { doc, getDoc } from 'firebase/firestore';\r\n\r\n\r\nexport const AuthContext = React.createContext();\r\nexport default function AuthProvider({ children }) {\r\n\r\n    const [currentUser, setCurrentUser] = useState(null);\r\n    const [socket, setSocket] = useState(null);\r\n\r\n    useEffect(() => {\r\n    setSocket(io.connect(\"http://localhost:4000\"));\r\n    onAuthStateChanged(auth, (user) => {\r\n        if(user){ //Nếu đăng nhập\r\n          const { uid } = user;\r\n          const UsersDocRef = doc(database, \"Users\", uid);\r\n          getDoc(UsersDocRef)\r\n          .then(docSnap => {\r\n            setCurrentUser(docSnap.data());\r\n          })\r\n          .catch(error => {\r\n            console.log('(x) In AuthProvider error: ', error);\r\n          });\r\n        } else{ //Nếu đăng xuất\r\n          setCurrentUser(user);\r\n        }\r\n    });\r\n    }, []);\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ currentUser, socket }}>  \r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n};"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,IAAT,EAAeC,QAAf;AACA,SAASC,kBAAT,QAAmC,eAAnC;AACA,SAASC,EAAT,QAAmB,kBAAnB;AACA,SAASC,GAAT,EAAcC,MAAd,QAA4B,oBAA5B;;AAGA,OAAO,IAAMC,WAAW,GAAGT,KAAK,CAACU,aAAN,EAApB;AACP,eAAe,SAASC,YAAT,OAAoC;EAAA,IAAZC,QAAY,QAAZA,QAAY;;EAE/C,gBAAsCV,QAAQ,CAAC,IAAD,CAA9C;EAAA;EAAA,IAAOW,WAAP;EAAA,IAAoBC,cAApB;;EACA,iBAA4BZ,QAAQ,CAAC,IAAD,CAApC;EAAA;EAAA,IAAOa,MAAP;EAAA,IAAeC,SAAf;;EAEAf,SAAS,CAAC,YAAM;IAChBe,SAAS,CAACV,EAAE,CAACW,OAAH,CAAW,uBAAX,CAAD,CAAT;IACAZ,kBAAkB,CAACF,IAAD,EAAO,UAACe,IAAD,EAAU;MAC/B,IAAGA,IAAH,EAAQ;QACN,IAAQC,GAAR,GAAgBD,IAAhB,CAAQC,GAAR;QACA,IAAMC,WAAW,GAAGb,GAAG,CAACH,QAAD,EAAW,OAAX,EAAoBe,GAApB,CAAvB;QACAX,MAAM,CAACY,WAAD,CAAN,CACCC,IADD,CACM,UAAAC,OAAO,EAAI;UACfR,cAAc,CAACQ,OAAO,CAACC,IAAR,EAAD,CAAd;QACD,CAHD,EAICC,KAJD,CAIO,UAAAC,KAAK,EAAI;UACdC,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2CF,KAA3C;QACD,CAND;MAOD,CAVD,MAUM;QACJX,cAAc,CAACI,IAAD,CAAd;MACD;IACJ,CAdiB,CAAlB;EAeC,CAjBQ,EAiBN,EAjBM,CAAT;EAmBF,OACE,KAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAAEL,WAAW,EAAXA,WAAF;MAAeE,MAAM,EAANA;IAAf,CAA7B;IAAA,UACGH;EADH,EADF;AAKD;AAAA"},"metadata":{},"sourceType":"module"}