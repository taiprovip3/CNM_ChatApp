{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport { collection, doc, getDoc, onSnapshot, orderBy, query, where } from 'firebase/firestore';\nimport { database } from \"../../firebase\";\n\nvar FirebaseGetFriendMessages = function FirebaseGetFriendMessages(idFriend, idUser) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      friendMessages = _useState2[0],\n      setFriendMessages = _useState2[1];\n\n  if (!idFriend || !idFriend.length || !idUser || !idUser.length) {\n    setFriendMessages([]);\n    return;\n  }\n\n  useEffect(function () {\n    var FriendMessagesCollectionRef = collection(database, 'FriendMessages');\n    var q = query(FriendMessagesCollectionRef, where(\"listeners\", \"array-contains\", idFriend), where(\"listeners\", \"array-contains\", idUser));\n    var unsubcribe = onSnapshot(q, function (querySnapShot) {\n      var documents = querySnapShot.docs.map(function (doc) {\n        return _objectSpread({}, doc.data().listObjectMessage);\n      });\n      setFriendMessages(documents);\n    });\n    return unsubcribe;\n  }, [idFriend, idUser]);\n  return friendMessages;\n};\n\nexport default FirebaseGetFriendMessages;","map":{"version":3,"names":["React","useEffect","useState","collection","doc","getDoc","onSnapshot","orderBy","query","where","database","FirebaseGetFriendMessages","idFriend","idUser","friendMessages","setFriendMessages","length","FriendMessagesCollectionRef","q","unsubcribe","querySnapShot","documents","docs","map","data","listObjectMessage"],"sources":["F:/Hoc ki 4/Cong nghe moi/AppChat/client/Components/service/FirebaseGetFriendMessages.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { collection, doc, getDoc, onSnapshot, orderBy, query, where } from 'firebase/firestore';\r\nimport { database } from '../../firebase';\r\n\r\n//UseEffect này luôn lắng nge\r\n//UseEffect này chỉ chạy lại khi biến owner lớp cha gọi nó thay đổi giá trị truyền vào\r\n//Nếu thay đổi hàm sẽ đc thực thi => trả về danh sách rooms mới.\r\nconst FirebaseGetFriendMessages = (idFriend, idUser) => {\r\n    const [friendMessages, setFriendMessages] = useState([]);\r\n    if(!idFriend || !idFriend.length || !idUser || !idUser.length){\r\n        setFriendMessages([]);\r\n        return;\r\n    }\r\n    useEffect(() => {\r\n        const FriendMessagesCollectionRef = collection(database, 'FriendMessages');\r\n        const q = query(FriendMessagesCollectionRef, where(\"listeners\", \"array-contains\", idFriend), where(\"listeners\", \"array-contains\", idUser));\r\n        const unsubcribe = onSnapshot(q, (querySnapShot) => {\r\n            const documents = querySnapShot.docs.map( (doc) => ({...doc.data().listObjectMessage}) );\r\n            setFriendMessages(documents);\r\n        });\r\n        return unsubcribe;\r\n    }, [idFriend, idUser]);\r\n    return friendMessages;\r\n};\r\n\r\nexport default FirebaseGetFriendMessages;"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,EAAqBC,GAArB,EAA0BC,MAA1B,EAAkCC,UAAlC,EAA8CC,OAA9C,EAAuDC,KAAvD,EAA8DC,KAA9D,QAA2E,oBAA3E;AACA,SAASC,QAAT;;AAKA,IAAMC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACC,QAAD,EAAWC,MAAX,EAAsB;EACpD,gBAA4CX,QAAQ,CAAC,EAAD,CAApD;EAAA;EAAA,IAAOY,cAAP;EAAA,IAAuBC,iBAAvB;;EACA,IAAG,CAACH,QAAD,IAAa,CAACA,QAAQ,CAACI,MAAvB,IAAiC,CAACH,MAAlC,IAA4C,CAACA,MAAM,CAACG,MAAvD,EAA8D;IAC1DD,iBAAiB,CAAC,EAAD,CAAjB;IACA;EACH;;EACDd,SAAS,CAAC,YAAM;IACZ,IAAMgB,2BAA2B,GAAGd,UAAU,CAACO,QAAD,EAAW,gBAAX,CAA9C;IACA,IAAMQ,CAAC,GAAGV,KAAK,CAACS,2BAAD,EAA8BR,KAAK,CAAC,WAAD,EAAc,gBAAd,EAAgCG,QAAhC,CAAnC,EAA8EH,KAAK,CAAC,WAAD,EAAc,gBAAd,EAAgCI,MAAhC,CAAnF,CAAf;IACA,IAAMM,UAAU,GAAGb,UAAU,CAACY,CAAD,EAAI,UAACE,aAAD,EAAmB;MAChD,IAAMC,SAAS,GAAGD,aAAa,CAACE,IAAd,CAAmBC,GAAnB,CAAwB,UAACnB,GAAD;QAAA,yBAAcA,GAAG,CAACoB,IAAJ,GAAWC,iBAAzB;MAAA,CAAxB,CAAlB;MACAV,iBAAiB,CAACM,SAAD,CAAjB;IACH,CAH4B,CAA7B;IAIA,OAAOF,UAAP;EACH,CARQ,EAQN,CAACP,QAAD,EAAWC,MAAX,CARM,CAAT;EASA,OAAOC,cAAP;AACH,CAhBD;;AAkBA,eAAeH,yBAAf"},"metadata":{},"sourceType":"module"}